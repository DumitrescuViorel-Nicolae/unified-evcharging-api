-- Create table for EV stations
CREATE TABLE EVStations (
    id INT PRIMARY KEY IDENTITY(1,1),
    brand NVARCHAR(255),
    totalNumberOfConnectors INT,
    street NVARCHAR(255),
    city NVARCHAR(255),
    country NVARCHAR(255),
    phone NVARCHAR(20),
    website NVARCHAR(255),
    latitude DECIMAL(9,6),
    longitude DECIMAL(9,6),
    CompanyName NVARCHAR(255),
    CompanyId INT
);

-- Create table for connector details
CREATE TABLE ConnectorDetail (
    id INT PRIMARY KEY IDENTITY(1,1),
    evStationId INT,
    supplierName NVARCHAR(255),
    connectorType NVARCHAR(255),
    chargeCapacity NVARCHAR(255),
    maxPowerLevel INT,
    customerChargeLevel NVARCHAR(10),
    customerConnectorName NVARCHAR(255),
    pay BIT,
    price DECIMAL(10, 2) DEFAULT 2.00
);

-- Create table for connector status
CREATE TABLE ConnectorStatus (
    id INT PRIMARY KEY IDENTITY(1,1),
    connectorDetailsId INT,
    physicalReference NVARCHAR(10),
    state NVARCHAR(50)
);

-- Create table for payment methods
CREATE TABLE PaymentMethod (
    id INT PRIMARY KEY IDENTITY(1,1),
    evStationId INT,
    ePaymentAccept BIT,
    otherPaymentAccept BIT,
    ePaymentTypes NVARCHAR(MAX),
    otherPaymentTypes NVARCHAR(MAX)
);

-- Create table for payment transactions
CREATE TABLE PaymentTransactions (
    transaction_id VARCHAR(50) PRIMARY KEY,
    amount DECIMAL(10, 2) NOT NULL,
    currency VARCHAR(3) NOT NULL,
    payment_method_brand VARCHAR(20),
    payment_method_last4 VARCHAR(4),
    status VARCHAR(20) NOT NULL,
    receipt_url VARCHAR(255),
    created_at DATETIME
);

-- Create table for registered companies
CREATE TABLE RegisteredCompanies (
    id INT PRIMARY KEY IDENTITY(1,1),
    UserId NVARCHAR(450) NOT NULL, -- Foreign key to AspNetUsers table
    CompanyName NVARCHAR(255) NOT NULL,
    StripeAccountID NVARCHAR(255),
    RegistrationNumber NVARCHAR(50),
    TaxNumber NVARCHAR(50),
    Country NVARCHAR(100),
    City NVARCHAR(100),
    StreetName NVARCHAR(255),
    ZipCode NVARCHAR(20),
    CONSTRAINT FK_RegisteredCompanies_AspNetUsers FOREIGN KEY (UserId) REFERENCES AspNetUsers(Id)
);

-- Create foreign key relationship between EVStations and RegisteredCompanies
ALTER TABLE EVStations
ADD CONSTRAINT FK_EVStations_RegisteredCompanies FOREIGN KEY (CompanyId) REFERENCES RegisteredCompanies(id);

-- Add indexes for performance
CREATE INDEX IX_RegisteredCompanies_UserId ON RegisteredCompanies(UserId);
CREATE INDEX IX_EVStations_CompanyId ON EVStations(CompanyId);




{
  "stripeAccountID": "stripe123",
  "brand": "E.ON",
  "totalNumberOfConnectors": 4,
  "address": {
    "street": "Main Street",
    "city": "Anytown",
    "country": "USA"
  },
  "contacts": {
    "phone": "123-456-7890",
    "website": "https://www.example.com"
  },
  "position": {
    "latitude": 40.7128,
    "longitude": -74.0060
  },
  "connectorDetails": [
    {
      "supplierName": "ABC Inc.",
      "connectorType": "Type 2",
      "chargeCapacity": "230-230VAC, 3-phase at max 32A",
      "maxPowerLevel": 22,
      "customerChargeLevel": "Level 3",
      "customerConnectorName": "Type 2 Connector",
      "connectorsStatuses": [
        {
          "physicalReference": "A1",
          "state": "Available"
        },
        {
          "physicalReference": "B2",
          "state": "Occupied"
        }
      ]
    }
  ],
  "paymentMethods": {
    "ePayment": {
      "accept": true,
      "types": {
        "type": [
          "online-apple-pay",
          "online-google-pay"
        ]
      }
    },
    "other": {
      "accept": true,
      "types": {
        "type": [
          "rfid-reader",
          "app",
          "contactless-card",
          "auth-by-car-plug-and-charge"
        ]
      }
    }
  }
}
